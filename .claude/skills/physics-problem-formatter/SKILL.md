---
name: physics-problem-formatter
description: 从 PDF 文件或图片文件中提取物理题目，按照标准化格式输出为 Markdown。自动提取题目配图和解析配图保存到 image 文件夹，使用 LaTeX 格式化公式。适用于物理题库整理、题目录入、PDF 题目数字化等场景。
---

# 物理题目格式化工具

## 概述

本技能用于将 PDF 格式或图片格式的物理题目转换为标准化的 Markdown 格式，同时提取并保存题目中的配图。

## 工作流程

1. 接收用户上传的 PDF 文件或图片
2. 提取文字内容和图片
3. 识别并分离每道题目
4. **先读取 `references/knowledge-tags.md` 获取允许的知识点标签列表**
5. 按标准格式输出每道题目
6. 将配图保存到 `image/` 文件夹

---

## ⚠️ 强制规则（必须严格遵守）

### 规则 1：知识点标签必须来自预定义列表

**禁止自行创造标签。** 所有知识点标签必须且只能从 `references/knowledge-tags.md` 文件中选取。

处理流程：
1. 在标注知识点前，**必须先读取** `references/knowledge-tags.md`
2. 根据题目内容，从文件中选择最匹配的 2-5 个标签
3. **如果找不到完全匹配的标签，选择最接近的上级概念标签**
4. **绝对禁止**使用文件中不存在的标签

### 规则 2：格式分隔符不可省略

- 每道题目**开头和结尾**必须有 `---` 分隔线
- 字段顺序必须严格按照模板

### 规则 3：LaTeX 公式统一格式

- **所有公式必须使用 `$$...$$` 格式**（包括行内公式）
- 禁止使用 `$...$` 单美元符号格式

### 规则 4：ID 和图片命名格式固定

- ID 格式：`P-{YYYY-MM}-{章节号}-{题目序号}`
- 图片格式：`P-{YYYY-MM}-{章节号}-{题目序号}-{question|analysis}.png`

---

## 输出格式模板

```markdown
---
## ID：P-{YYYY-MM}-{章节号}-{题目序号}
**知识点**：#标签1,#标签2,#标签3
**难度**：{0.1-1.0}
**题型**：{单选题|多选题|填空题|计算题|实验题}
**题目描述**：{题目正文}
{如有题目配图：![图片描述](image/P-{YYYY-MM}-{章节号}-{题目序号}-question.png)}
**选项**：（选择题必须有此字段）
A. 选项内容
B. 选项内容
C. 选项内容
D. 选项内容
**答案**：{正确答案}
**解析**：{详细解析}
{如有解析配图：![图片描述](image/P-{YYYY-MM}-{章节号}-{题目序号}-analysis.png)}
---
```

---

## ID 命名规则

格式：`P-{YYYY-MM}-{章节号}-{题目序号}`

| 部分 | 说明 | 示例 |
|------|------|------|
| P | 物理学科标识 | P |
| YYYY-MM | 录入年月 | 2026-01 |
| 章节号 | 对应 knowledge-tags.md 中的章节 | 1.1, 2.1, 5.3 |
| 题目序号 | 三位数字，从 001 开始 | 001, 012, 099 |

完整示例：`P-2026-01-1.4-012`（2026年1月录入，第一章第四节，第12题）

---

## 知识点标签规范

### 标签来源

**唯一来源**：`references/knowledge-tags.md`

### 标签格式

- 使用 `#` 前缀
- 多个标签用**英文逗号**分隔，逗号后**无空格**
- 标签数量：2-5 个

正确示例：
```
**知识点**：#加速度,#位移,#曲线运动
```

错误示例：
```
**知识点**：#加速度, #位移, #曲线运动    ← 逗号后有空格，错误
**知识点**：#轨迹长度,#月球引力          ← 标签不在列表中，错误
```

### 标签选择优先级

1. 优先选择**最具体**的标签（如 #自由落体 优于 #匀变速直线运动）
2. 如果题目涉及多个章节，选择**最核心**的知识点
3. 可以同时包含**方法标签**（如 #整体法与隔离法）和**内容标签**（如 #牛顿第二定律）

---

## 难度标准

| 难度值 | 等级 | 典型特征 |
|--------|------|----------|
| 0.1-0.3 | 简单 | 直接套用公式，单一知识点 |
| 0.4-0.6 | 中等 | 需要简单推导，2-3个知识点结合 |
| 0.7-0.8 | 较难 | 多步骤推导，综合应用 |
| 0.9-1.0 | 困难 | 创新题型，竞赛难度 |

---

## LaTeX 公式规范

**统一使用 `$$...$$` 格式，禁止使用 `$...$`**

常用符号：
| 符号 | LaTeX 代码 | 渲染效果 |
|------|------------|----------|
| 分数 | `\frac{a}{b}` | $$\frac{a}{b}$$ |
| 乘号 | `\times` | $$\times$$ |
| 根号 | `\sqrt{x}` | $$\sqrt{x}$$ |
| 上标 | `x^2` | $$x^2$$ |
| 下标 | `x_1` | $$x_1$$ |
| 向量 | `\vec{v}` | $$\vec{v}$$ |
| 单位 | `\text{m/s}` | $$\text{m/s}$$ |
| 希腊字母 | `\alpha, \beta, \theta` | $$\alpha, \beta, \theta$$ |

---

## 图片处理

### 命名规则

格式：`P-{YYYY-MM}-{章节号}-{题目序号}-{类型}.png`

| 类型 | 说明 |
|------|------|
| question | 题目配图 |
| analysis | 解析配图 |

示例：
- `P-2026-01-5.1-014-question.png`
- `P-2026-01-5.1-014-analysis.png`

### 保存位置

所有图片保存到仓库根目录下的 `image/` 文件夹

### Markdown 引用格式

```markdown
![图片描述](image/P-2026-01-5.1-014-question.png)
```

---

## 完整输出示例

以下示例中的知识点标签均来自 `references/knowledge-tags.md`：

```markdown
---
## ID：P-2026-01-5.1-014
**知识点**：#曲线运动,#位移,#加速度
**难度**：0.7
**题型**：单选题
**题目描述**：(2023·浙江6月·4)图为"玉兔二号"巡视器在月球上从O点行走到B点的照片，OA段为直线，AB段是曲线，巡视器质量为135 kg，则巡视器
![玉兔二号月球车照片](image/P-2026-01-5.1-014-question.png)
**选项**：
A. 受到月球的引力为1 350N
B. 在AB段运动时一定有加速度
C. OA段与AB段的平均速度方向相同
D. 从O到B的位移大小等于OAB轨迹长度
**答案**：B
**解析**：由于月球表面的重力加速度是地球表面重力加速度的 $$\frac{1}{6}$$，则巡视器受到月球的引力约为 $$\frac{1}{6} \times 1350$$ N $$= 225$$ N，A错误。因为AB段的速度方向改变，即其加速度一定不等于零，B正确。OA段为直线，AB段为曲线，则OA段的平均速度的方向与AB段的平均速度的方向一定不相同，C错误。从O到B的位移大小一定小于OAB轨迹长度，D错误。
---
```

```markdown
---
## ID：P-2026-01-1.1-012
**知识点**：#速度,#声速,#光速,#误差分析
**难度**：0.7
**题型**：单选题
**题目描述**：(2005·北京·19)一看到闪电12.3s后又听到雷声，已知空气中的声速为330～340m/s，光速为 $$3 \times 10^{8}$$ m/s，于是他用12.3除以3得到从发出闪电发生位置到他的距离为4.1km.根据所掌握的物理知识可以判断( )
**选项**：
A. 这种估算方法是错误的，不可采用
B. 这种估算方法可以比较准确估算出闪电发生位置与观察者的距离
C. 这种估算方法没有考虑光的传播时间，结果误差太大
D. 即使声速增大2倍以上，本题的估算仍然有效
**答案**：B
**解析**：考虑光的传播时间 $$t_0$$，解答如下：$$s = ct_0$$，$$s = v(t_0 + t)$$，解得 $$s = \frac{vct}{c-v}$$。若不考虑光的传播时间，则闪电发生位置到观察者间距离为 $$s' = vt$$，则两次计算的相对误差 $$\frac{s-s'}{s} = \frac{v}{c}$$。因 $$v \ll c$$，故光传播时间对结果影响很小，故B正确。
---
```

---

## 处理检查清单

完成每道题目后，检查以下项目：

- [ ] `---` 分隔符：开头和结尾都有
- [ ] ID 格式：`P-YYYY-MM-章节号-序号`
- [ ] 知识点：全部来自 `references/knowledge-tags.md`
- [ ] 知识点格式：`#标签1,#标签2`（逗号后无空格）
- [ ] 难度：0.1-1.0 之间的数值
- [ ] 题型：单选题|多选题|填空题|计算题|实验题 之一
- [ ] LaTeX：全部使用 `$$...$$` 格式
- [ ] 图片命名：符合 `P-YYYY-MM-章节号-序号-类型.png` 格式
- [ ] 图片路径：`image/` 开头

---

## 常见错误及修正

| 错误类型 | 错误示例 | 正确示例 |
|----------|----------|----------|
| 自创标签 | `#轨迹长度` | 使用 `#位移` 或 `#曲线运动` |
| 逗号格式 | `#标签1, #标签2` | `#标签1,#标签2` |
| 公式格式 | `$v=at$` | `$$v=at$$` |
| 分隔符缺失 | 题目间无分隔 | 每题首尾都有 `---` |
| 路径错误 | `images/` | `image/` |
