---
name: physics-problem-formatter
description: 从 PDF 文件中提取物理题目，按照标准化格式输出为 Markdown。自动提取题目配图和解析配图保存到 image 文件夹，使用 LaTeX 格式化公式。适用于物理题库整理、题目录入、PDF 题目数字化等场景。
---

# 物理题目格式化工具

## 概述

本技能用于将 PDF 格式的物理题目转换为标准化的 Markdown 格式，同时提取并保存题目中的配图。

## 工作流程

1. 接收用户上传的 PDF 文件
2. 提取 PDF 中的文字内容和图片
3. 识别并分离每道题目
4. 按标准格式输出每道题目
5. 将配图保存到 `image/` 文件夹

## 输出格式规范

每道题目必须按以下格式输出，题目之间用 `---` 分隔：

```markdown
---
## ID：P-{YYYY-MM}-{章节号}-{题目序号}
**知识点**：#标签1,#标签2,#标签3
**难度**：{0.1-1.0}
**题型**：{单选题|多选题|填空题|计算题|实验题}
**题目描述**：{题目正文，包含 LaTeX 公式}
{如有题目配图：![图片描述](image/P-{YYYY-MM}-{章节号}-{题目序号}-question.png)}
**选项**：（如适用）
A. 选项内容
B. 选项内容
C. 选项内容
D. 选项内容
**答案**：{正确答案}
**解析**：{详细解析，包含 LaTeX 公式}
{如有解析配图：![图片描述](image/P-{YYYY-MM}-{章节号}-{题目序号}-analysis.png)}
---
```

## ID 命名规则

格式：`P-{YYYY-MM}-{章节号}-{题目序号}`

- `P`：Physics 物理学科标识
- `YYYY-MM`：录入年月（如 2026-01）
- `章节号`：知识点章节编号（如 1.1 表示第一章第一节）
- `题目序号`：三位数字，从 001 开始

示例：`P-2026-01-1.1-012`

## 图片命名规则

格式：`P-{YYYY-MM}-{章节号}-{题目序号}-{图片类型}.png`

图片类型：
- `question`：题目配图
- `analysis`：解析配图

示例：
- `P-2026-01-1.1-014-question.png`（题目配图）
- `P-2026-01-1.1-014-analysis.png`（解析配图）

## 知识点标签规范

使用 `#` 前缀，多个标签用英文逗号分隔：

```
**知识点**：#速度,#加速度,#匀变速直线运动
```

常用知识点标签参考：
- 运动学：#位移,#速度,#加速度,#匀速直线运动,#匀变速直线运动,#自由落体,#抛体运动
- 力学：#牛顿第一定律,#牛顿第二定律,#牛顿第三定律,#摩擦力,#弹力,#重力
- 能量：#动能,#势能,#机械能守恒,#功,#功率
- 电磁学：#电场,#电势,#电流,#电阻,#磁场,#电磁感应
- 光学：#光的反射,#光的折射,#光速
- 声学：#声速,#声波
- 其他：#误差分析,#实验设计,#数据处理

## 难度标准

采用 0.1-1.0 的十分制：

| 难度值 | 描述 | 典型特征 |
|--------|------|----------|
| 0.1-0.3 | 简单 | 直接套用公式，单一知识点 |
| 0.4-0.6 | 中等 | 需要简单推导，2-3个知识点结合 |
| 0.7-0.8 | 较难 | 多步骤推导，综合应用 |
| 0.9-1.0 | 困难 | 创新题型，竞赛难度 |

## LaTeX 公式规范

- 行内公式：使用 `$...$`，如 `$v = \frac{s}{t}$`
- 独立公式：使用 `$$...$$`
- 常用符号：
  - 分数：`\frac{a}{b}`
  - 乘号：`\times`
  - 根号：`\sqrt{x}`
  - 上下标：`x^2`、`x_1`
  - 希腊字母：`\alpha`、`\beta`、`\theta`
  - 向量：`\vec{v}`
  - 单位：`\text{m/s}`

## 图片提取流程

1. 使用 pdfimages 或 pdf2image 提取 PDF 中的图片
2. 根据图片在 PDF 中的位置判断属于题目还是解析
3. 按命名规则重命名图片
4. 保存到仓库的 `image/` 文件夹
5. 在 Markdown 中插入正确的图片引用

```python
from pdf2image import convert_from_path
from PIL import Image
import os

def extract_images(pdf_path, output_dir, problem_id):
    """提取 PDF 中的图片并按规范命名"""
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)
    
    # 转换 PDF 页面为图片进行分析
    pages = convert_from_path(pdf_path)
    
    # 提取并保存图片
    # 题目配图
    question_img_path = f"{output_dir}/{problem_id}-question.png"
    # 解析配图
    analysis_img_path = f"{output_dir}/{problem_id}-analysis.png"
    
    return question_img_path, analysis_img_path
```

## 完整输出示例

```markdown
---
## ID：P-2026-01-1.1-014
**知识点**：#加速度,#位移,#轨迹长度
**难度**：0.7
**题型**：单选题
**题目描述**：(2023·浙江6月·4)图为"玉兔二号"巡视器在月球上从O点行走到B点的照片，OA段为直线，AB段是曲线，巡视器质量为135 kg，则巡视器
![玉兔二号月球车照片](image/P-2026-01-1.1-014-question.png)
**选项**：
A. 受到月球的引力为1 350N
B. 在AB段运动时一定有加速度
C. OA段与AB段的平均速度方向相同
D. 从O到B的位移大小等于OAB轨迹长度
**答案**：B
**解析**：由于月球表面的重力加速度是地球表面重力加速度的 $\frac{1}{6}$，则巡视器受到月球的引力约为 $\frac{1}{6} \times 1350$ N $= 225$ N，A错误。因为AB段的速度方向改变，即其加速度一定不等于零，B正确。OA段为直线，AB段为曲线，则OA段的平均速度的方向与AB段的平均速度的方向一定不相同，C错误。从O到B的位移大小一定小于OAB轨迹长度，D错误。
---
```

## 处理注意事项

1. **公式转换**：确保所有数学公式都转换为 LaTeX 格式
2. **图片质量**：提取的图片应保持清晰，建议 PNG 格式
3. **知识点准确**：根据题目内容准确标注知识点标签
4. **难度评估**：综合考虑计算量、知识点数量、思维难度
5. **格式一致**：严格遵循模板格式，确保后续处理兼容性
6. **分隔符**：每道题目之间必须使用 `---` 分隔

## 常见问题处理

### PDF 文字识别不准确
使用 OCR 工具（pytesseract）辅助识别，特别是扫描件

### 图片位置判断困难
根据图片在页面中的相对位置和上下文判断：
- 出现在题目文字附近 → 题目配图
- 出现在解析文字附近 → 解析配图

### 公式识别
复杂公式可能需要人工校对，特别注意：
- 分数线
- 上下标
- 希腊字母
- 向量符号
